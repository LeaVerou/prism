var expressionDef=function(e){return void 0===e&&(e=!0),e?/\{[^\r\n\[\]{]*\}(?=[^\r\n\[\]\}]*)/m:/\{[^\r\n\[\]{}]*\}/};Prism.languages.naniscript={comment:{pattern:/^([\t ]*);[^\r\n]*$/m,lookbehind:!0},define:{pattern:/^>.+$/m,alias:"tag",inside:{value:{pattern:/(^>[a-zA-Z0-9_]+)[\t ]+[^{}\r\n]+/,alias:"operator",lookbehind:!0},key:{pattern:/(^>)[a-zA-Z0-9_]+/,lookbehind:!0}}},label:{pattern:/^([\t ]*)[#]{1}[\t ]*[a-zA-Z0-9]+[\t ]?$/m,alias:"regex",lookbehind:!0},"generic-text":{pattern:/^[^#@>;\s]{1}.*$/m,alias:"punctuation",inside:{"escaped-char":{pattern:/\\[{}\[\]"]{1}/m},expression:{pattern:expressionDef(),greedy:!0,alias:"selector"},"inline-command":{pattern:/\[[\t ]*[a-zA-Z0-9_]+[^\r\n\[]*\]/m,greedy:!0,alias:"function",inside:{"quoted-string":{pattern:/"(?:[^"\\]|\\.)*"/},"command-param-id":{alias:"property",pattern:/([^"\\]?)[a-zA-Z0-9_]+:/,lookbehind:!0},"command-param-name":{pattern:/^(\[)[\t ]*[a-zA-Z0-9_]+/,alias:"name",lookbehind:!0},"start-stop-char":/[\[\]]{1}/,"command-param-value":[{pattern:expressionDef(!1),alias:"selector"},{pattern:/([\t ]+).+?(?=[\t ]|$)/,alias:"operator",greedy:!0,lookbehind:!0},{pattern:/.+/,alias:"operator"}]}}}},command:{pattern:/^([\t ]*)@[a-zA-Z0-9_]+(?=[\t ]+[\S]{1,}|[\t ]+['"][\S]|[\t ]+$|$).*/m,lookbehind:!0,alias:"function",inside:{expression:{pattern:expressionDef(),greedy:!0,alias:"selector"},whitespaces:/[\t ]+$/,"command-name":/^[\t ]*@[a-zA-Z0-9_]+/,"command-params":{pattern:/[^\n]+$/,inside:{"quoted-string":{pattern:/"(?:[^"\\]|\\.)*"/,alias:"operator"},"command-param-id":{alias:"property",pattern:/([^"\\]?) [a-zA-Z0-9_]+:/,lookbehind:!0},"command-param-value":[{pattern:expressionDef(!1),alias:"selector"},{pattern:/([\t ]+).+?(?=[\t ]|$)/,alias:"operator",greedy:!0,lookbehind:!0},{pattern:/.+/,alias:"operator"}]}}}}},Prism.languages.nani=Prism.languages.naniscript,Prism.hooks.add("after-tokenize",function(n){n.tokens.map(function(e,t){if("generic-text"===e.type){var a=getContents(e,[]).join("");isBracketsBalanced(a)||(e.type="bad-line",e.content=a,n.tokens[t]=e)}return!1})});var isBracketsBalanced=function(e){for(var t=[],a=0,n=e;a<n.length;a++){var r=n[a],i="[]{}".indexOf(r);if(-1!==i)if(i%2==0)t.push(i+1);else if(t.pop()!==i)return!1}return 0===t.length};function getContents(e,t){return t=t||[],"string"==typeof e?t.push(e):"string"==typeof e.content?t.push(e.content):Array.isArray(e.content)&&e.content.forEach(function(e){getContents(e,t)}),t}